
name: test macOS binary

on:
  push:
  workflow_dispatch:

jobs:
  test:
    runs-on: macos-latest

    steps:
    - name: Download binary from main project
      run: |        
        VERSION="craterstats-3.6.3-macOS-arm64-beta"
        mkdir ~/craterstats
        cd ~/craterstats
        curl -o "$VERSION.zip" -L https://github.com/ggmichael/craterstats/releases/download/v3.6.3/craterstats-3.6.3-macOS-arm64-beta.zip
        unzip "$VERSION.zip"
        ls
        xattr -dr com.apple.quarantine craterstats

    - name: Add alias to zsh
      run: |
        echo "alias craterstats='~/craterstats/craterstats/craterstats'" >> $HOME/.zshrc
        echo "alias created"

    - name: Run a test command
      run: |
        cd ~/craterstats/craterstats
        ./craterstats -about
        cd ~
        craterstats -v
